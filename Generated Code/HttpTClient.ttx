<#@ template debug="false" hostspecific="false" language="C#" #>
<#@ import namespace="System.Net" #>
<#@ import namespace="System.Net.Http.Headers" #>
<#@ import namespace="System.Text" #>
<#@ import namespace="System.Text.Json" #>
<#@ import namespace="using Newtonsoft.Json" #>
<#@ import namespace="System.Collections.Generic" #>
//<#@ output extension=".txt" #>

// ------------------------------------------------------------------------------
// <auto-generated>
// This code was generated by a T4 template.
// </auto-generated>
// ------------------------------------------------------------------------------
//namespace <#= _namespace #>;

internal class HttpGenericClient<T>
{
    public async Task<JsonDocument?> GetAsync(string requestUri, Dictionary<string, string>? contentsParams = null, string token = "")
    {
        try
        {
            using (var client = new HttpClient())
            {
                client.DefaultRequestHeaders.Accept.Clear();
                client.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue("*/*"));
                client.DefaultRequestHeaders.Add("Host", Endpoints.Host);
                client.DefaultRequestHeaders.Add("Connection", "keep-alive");
                if (token.Length > 0)
                    client.DefaultRequestHeaders.Add("Authorization", $"Bearer {token}");
                if (contentsParams is not null)
                {
                    var content = new FormUrlEncodedContent(contentsParams);
                    string paramAsJSON = System.Text.Json.JsonSerializer.Serialize(content);
                    var contents = new StringContent(paramAsJSON, Encoding.UTF8, "application/json");
                }
                HttpResponseMessage response = await client.GetAsync(requestUri);
                if (response.IsSuccessStatusCode && response.Content is object)
                {
                    try
                    {
                        return JsonDocument.Parse(await response.Content.ReadAsStringAsync());
                    }
                    catch (Exception ex2)
                    {
                        Console.WriteLine(ex2.Message);
                        return null;
                    }
                }
                else
                {
                    return null;
                }
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
            return null;
        }
    }
}
